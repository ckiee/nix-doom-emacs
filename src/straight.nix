{ # Package set to build the Emacs environment from
emacsPackages
  # Emacs package to use during build
, emacs ? emacsPackages.emacs
  # Your `init.el` file to use for discovering and installing packages
, emacsInitFile
# Additional argument to pass to Emacs or your init file
, emacsArgs ? [ ]
  # Additional files you wish to load prior to executing package discovery
  # Good place to place to call `advice-add` from
, emacsLoadFiles ? [ ]
  # Abort processing if a package not found in `emacsPackages`
  # Setting it to false will result in just skipping an unavailable package
, abortOnNotFound ? true
  #
, lib }:

let
  epkgs = emacsPackages.overrideScope'
    (self: super: { straight = self.callPackage ./straight { }; });

  recipesIFD = epkgs.callPackage ({ stdenv }:
    stdenv.mkDerivation {
      name = "emacs-straight-packages.json";
      buildInputs = [ emacs ];
      dontUnpack = true;
      buildPhase = ":";
      installPhase = ''
        runHook preInstall
        # TODO/CONTINUE: Overhaul this, replace n-s-get-used-packages and emacsArgs as
        # used in ./default.nix to instead run a doomscript (or maybe bin/doom shebang, very similar..)
        # which dumps everything without hacking into the existing Doom CLI commands.
        # Once that's done, we can flush and read straight--recipe-cache for most metadata,
        # and also include the commit revs from doom-packages.
        #
        # I expect network activity for fetching the package metadata only,
        # and then fetchFromGithub/fetchurl/â€¦ in Nix using the output of this derivation,
        # which will be a FOD and is already an IFD. (but will turn into more than a list of packages)
        #
        # Appendix, on a nix-shell'd imperative doom emacs after evaluating (straight-normalize-all)
        # and maybe some others:
        # (json-encode doom-packages) ; "{\"use-package\":{\"modules\":{\"config\":\"use-package\"},\"pin\":\"a6e856418d2ebd053b34e0ab2fda328abeba731c\"},\"auto-minor-mode\":{\"modules\":{\"core\":null},\"pin\":\"17cfa1b54800fdef2975c0c0531dad34846a5065\"},\"gcmh\":{\"modules\":{\"core\":null},\"pin\":\"0089f9c3a6d4e9a310d0791cf6fa8f35642ecfd9\"},\"explain-pause-mode\":{\"modules\":{\"core\":null},\"recipe\":{\"host\":\"github\",\"repo\":\"lastquestion/explain-pause-mode\"},\"pin\":\"2356c8c3639cbeeb9751744dbe737267849b4b51\"},\"straight\":{\"modules\":{\"core\":null},\"type\":\"core\",\"recipe\":{\"host\":\"github\",\"repo\":\"radian-software/straight.el\",\"branch\":\"develop\",\"local-repo\":\"straight.el\",\"files\":[\"straight*.el\"]},\"pin\":\"5e84c4e2cd8ca79560477782ee4c9e5187725def\"},\"all-the-icons\":{\"modules\":{\"core\":null},\"pin\":\"be9d5dcda9c892e8ca1535e288620eec075eb0be\"},\"nerd-icons\":{\"modules\":{\"core\":null},\"pin\":\"619a0382d2e159f3142c4200fe4cfc2e89247ef1\"},\"hide-mode-line\":{\"modules\":{\"core\":null},\"pin\":\"bc5d293576c5e08c29e694078b96a5ed85631942\"},\"highlight-numbers\":{\"modules\":{\"core\":null},\"pin\":\"8b4744c7f46c72b1d3d599d4fb75ef8183dee307\"},\"rainbow-delimiters\":{\"modules\":{\"core\":null},\"pin\":\"f40ece58df8b2f0fb6c8576b527755a552a5e763\"},\"restart-emacs\":{\"modules\":{\"core\":null},\"pin\":\"1607da2bc657fe05ae01f7fdf26f716eafead02c\"},\"better-jumper\":{\"modules\":{\"core\":null},\"pin\":\"47622213783ece37d5337dc28d33b530540fc319\"},\"dtrt-indent\":{\"modules\":{\"core\":null},\"pin\":\"e0630f74f915c6cded05f76f66d66e540fcc37c3\"},\"helpful\":{\"modules\":{\"core\":null},\"pin\":\"66ba816b26b68dd7df08e86f8b96eaae16c8d6a2\"},\"pcre2el\":{\"modules\":{\"core\":null},\"pin\":\"018531ba0cf8e2b28d1108136a0e031b6a45f1c1\"},\"smartparens\":{\"modules\":{\"core\":null},\"pin\":\"79a338db115f441cd47bb91e6f75816c5e78a772\"},\"ws-butler\":{\"modules\":{\"core\":null},\"recipe\":{\"host\":\"github\",\"repo\":\"hlissner/ws-butler\",\"flavor\":\"melpa\"},\"pin\":\"572a10c11b6cb88293de48acbb59a059d36f9ba5\"},\"projectile\":{\"modules\":{\"core\":null},\"pin\":\"971cd5c4f25ff1f84ab7e8337ffc7f89f67a1b52\"},\"project\":{\"modules\":{\"core\":null},\"pin\":\"ce140cdb70138a4938c999d4606a52dbeced4676\"},\"general\":{\"modules\":{\"core\":null},\"pin\":\"833dea2c4a60e06fcd552b653dfc8960935c9fb4\"},\"which-key\":{\"modules\":{\"core\":null},\"pin\":\"4d20bc852545a2e602f59084a630f888542052b1\"},\"compat\":{\"modules\":{\"core\":null},\"recipe\":{\"host\":\"github\",\"repo\":\"emacs-compat/compat\",\"files\":[\"*\",{\"exclude\":\".git\"}]},\"pin\":\"ecf53005abf6f0325d14e0e024222e22e982c8dd\"},\"company\":{\"modules\":{\"completion\":\"company\"},\"pin\":\"2ca3e29abf87392714bc2b26e50e1c0f4b9f4e2c\"},\"company-dict\":{\"modules\":{\"completion\":\"company\"},\"pin\":\"cd7b8394f6014c57897f65d335d6b2bd65dab1f4\"},\"vertico\":{\"modules\":{\"completion\":\"vertico\"},\"recipe\":{\"host\":\"github\",\"repo\":\"minad/vertico\",\"files\":[\"*.el\",\"extensions/*.el\"],\"flavor\":\"melpa\"},\"pin\":\"a28370d07f35c5387c7a9ec2e5b67f0d4598058d\"},\"orderless\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"e6784026717a8a6a7dcd0bf31fd3414f148c542e\"},\"consult\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"fe49dedd71802ff97be7b89f1ec4bd61b98c2b13\"},\"consult-dir\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"ed8f0874d26f10f5c5b181ab9f2cf4107df8a0eb\"},\"consult-flycheck\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"3f2a7c17cc2fe64e0c07e3bf90e33c885c0d7062\"},\"embark\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"9a44418c349e41020cdc5ad1bd21e8c77a429062\"},\"embark-consult\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"9a44418c349e41020cdc5ad1bd21e8c77a429062\"},\"marginalia\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"866e50aee4f066b0903752c69b33e9b7cab93f97\"},\"wgrep\":{\"modules\":{\"completion\":\"vertico\"},\"pin\":\"3132abd3750b8c87cbcf6942db952acfab5edccd\"},\"doom-themes\":{\"modules\":{\"ui\":\"doom\"},\"pin\":\"4aee1f5a0e54552669f747aa7c25e6027e73d76d\"},\"solaire-mode\":{\"modules\":{\"ui\":\"doom\"},\"pin\":\"8af65fbdc50b25ed3214da949b8a484527c7cc14\"},\"hl-todo\":{\"modules\":{\"ui\":\"hl-todo\"},\"pin\":\"70ce48470c85f1441de2c9428a240c3287995846\"},\"doom-modeline\":{\"modules\":{\"ui\":\"modeline\"},\"pin\":\"93f240f7a0bf35511cfc0a8dd75786744b4bcf77\"},\"anzu\":{\"modules\":{\"ui\":\"modeline\"},\"pin\":\"5abb37455ea44fa401d5f4c1bdc58adb2448db67\"},\"evil-anzu\":{\"modules\":{\"ui\":\"modeline\"},\"pin\":\"d1e98ee6976437164627542909a25c6946497899\"},\"evil-goggles\":{\"modules\":{\"ui\":\"ophints\"},\"pin\":\"0070c9d8447e1696f8713d0c13ff64ef0979d580\"},\"git-gutter-fringe\":{\"modules\":{\"ui\":\"vc-gutter\"},\"pin\":\"648cb5b57faec55711803cdc9434e55a733c3eba\"},\"vi-tilde-fringe\":{\"modules\":{\"ui\":\"vi-tilde-fringe\"},\"pin\":\"f1597a8d54535bb1d84b442577b2024e6f910308\"},\"persp-mode\":{\"modules\":{\"ui\":\"workspaces\"},\"pin\":\"df95ea710e2a72f7a88293b72137acb0ca024d90\"},\"evil\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"5fc16776c5eb00c956ec7e9d83facb6a38dd868d\"},\"evil-args\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"2671071a4a57eaee7cc8c27b9e4b6fc60fd2ccd3\"},\"evil-easymotion\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"f96c2ed38ddc07908db7c3c11bcd6285a3e8c2e9\"},\"evil-embrace\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"3081d37811b6a3dfaaf01d578c7ab7a746c6064d\"},\"evil-escape\":{\"modules\":{\"editor\":\"evil\"},\"recipe\":{\"host\":\"github\",\"repo\":\"hlissner/evil-escape\",\"flavor\":\"melpa\"},\"pin\":\"819f1ee1cf3f69a1ae920e6004f2c0baeebbe077\"},\"evil-exchange\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"5f0a2d41434c17c6fb02e4f744043775de1c63a2\"},\"evil-indent-plus\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"b4dacbfdb57f474f798bfbf5026d434d549eb65c\"},\"evil-lion\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"1e838a53b8f18a3c8bdf3e952186abc2ee9cb98e\"},\"evil-nerd-commenter\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"3b197a2b559b06a7cf39978704b196f53dac802a\"},\"evil-numbers\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"7a1b62afc12da2b582bf84d722e7b10ca8b97065\"},\"evil-snipe\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"c2108d3932fcd2f75ac3e48250d6badd668f5b4f\"},\"evil-surround\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"8fad8540c490d94a820004f227552ca08e3e3857\"},\"evil-textobj-anyblock\":{\"modules\":{\"editor\":\"evil\"},\"recipe\":{\"host\":\"github\",\"repo\":\"willghatch/evil-textobj-anyblock\",\"branch\":\"fix-inner-block\",\"flavor\":\"melpa\"},\"pin\":\"29280cd71a05429364cdceef2ff595ae8afade4d\"},\"evil-traces\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"82e8a7b4213aed140f6eb5f2cc33a09bb5587166\"},\"evil-visualstar\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"06c053d8f7381f91c53311b1234872ca96ced752\"},\"exato\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"aee7af7b7a0e7551478f453d1de7d5b9cb2e06c4\"},\"evil-quick-diff\":{\"modules\":{\"editor\":\"evil\"},\"recipe\":{\"host\":\"github\",\"repo\":\"rgrinberg/evil-quick-diff\"},\"pin\":\"69c883720b30a892c63bc89f49d4f0e8b8028908\"},\"evil-collection\":{\"modules\":{\"editor\":\"evil\"},\"pin\":\"8be4b75c86bc637dbcd14be7522d6da06df1747e\"},\"yasnippet\":{\"modules\":{\"editor\":\"file-templates\",\"editor\":\"snippets\"},\"pin\":\"76e1eee654ea9479ba1441f9c17567694e6a2096\"},\"hideshow\":{\"modules\":{\"editor\":\"fold\"},\"ignore\":true},\"vimish-fold\":{\"modules\":{\"editor\":\"fold\"},\"pin\":\"a6501cbfe3db791f9ca17fd986c7202a87f3adb8\"},\"evil-vimish-fold\":{\"modules\":{\"editor\":\"fold\"},\"pin\":\"b6e0e6b91b8cd047e80debef1a536d9d49eef31a\"},\"auto-yasnippet\":{\"modules\":{\"editor\":\"snippets\"},\"pin\":\"6a9e406d0d7f9dfd6dff7647f358cb05a0b1637e\"},\"doom-snippets\":{\"modules\":{\"editor\":\"snippets\"},\"recipe\":{\"host\":\"github\",\"repo\":\"doomemacs/snippets\",\"files\":{\"defaults\":\"*\"}},\"pin\":\"d490cba6d762e69b483be308bc387c1f785742f0\"},\"diredfl\":{\"modules\":{\"emacs\":\"dired\"},\"pin\":\"f9140b2c42151dca669003d685c9f079b2e3dc37\"},\"dired-git-info\":{\"modules\":{\"emacs\":\"dired\"},\"pin\":\"9461476a28a5fec0784260f6e318237c662c3430\"},\"dired-rsync\":{\"modules\":{\"emacs\":\"dired\"},\"pin\":\"7940d9154d0a908693999b0e1ea351a6d365c93d\"},\"fd-dired\":{\"modules\":{\"emacs\":\"dired\"},\"pin\":\"458464771bb220b6eb87ccfd4c985c436e57dc7e\"},\"undo-fu\":{\"modules\":{\"emacs\":\"undo\"},\"pin\":\"0e74116fd5c7797811a91ba4eadef50d67523eb6\"},\"undo-fu-session\":{\"modules\":{\"emacs\":\"undo\"},\"pin\":\"a6c4f73bc22401fd36e0f2fd4fe058bb28566d84\"},\"vundo\":{\"modules\":{\"emacs\":\"undo\"},\"pin\":\"24271862a2f746be038306eafe20f5eff55c4566\"},\"vc\":{\"modules\":{\"emacs\":\"vc\"},\"ignore\":true},\"vc-annotate\":{\"modules\":{\"emacs\":\"vc\"},\"ignore\":true},\"smerge-mode\":{\"modules\":{\"emacs\":\"vc\"},\"ignore\":true},\"browse-at-remote\":{\"modules\":{\"emacs\":\"vc\"},\"pin\":\"c020975a891438e278ad1855213d4f3d62c9fccb\"},\"git-commit\":{\"modules\":{\"emacs\":\"vc\"},\"pin\":\"48818355728c48d986d74dde8b1e9fba25f0fd53\"},\"git-timemachine\":{\"modules\":{\"emacs\":\"vc\"},\"recipe\":{\"host\":\"github\",\"repo\":\"emacsmirror/git-timemachine\",\"flavor\":\"melpa\"},\"pin\":\"d8ffd0d7cc4ab3dd7de494c9ea36dfd99e2744fa\"},\"git-modes\":{\"modules\":{\"emacs\":\"vc\"},\"pin\":\"f0a0154bf48dd1c0c587596cf4cfd3c90f673a05\"},\"flycheck\":{\"modules\":{\"checkers\":\"syntax\"},\"pin\":\"784f184cdd9f9cb4e3dbb997c09d93e954142842\"},\"flycheck-popup-tip\":{\"modules\":{\"checkers\":\"syntax\"},\"pin\":\"ef86aad907f27ca076859d8d9416f4f7727619c6\"},\"quickrun\":{\"modules\":{\"tools\":\"eval\"},\"pin\":\"6f963189305e8311c8193ba774f4244eb1315f57\"},\"eros\":{\"modules\":{\"tools\":\"eval\"},\"pin\":\"a9a92bdc6be0521a6a06eb464be55ed61946639c\"},\"dumb-jump\":{\"modules\":{\"tools\":\"lookup\"},\"pin\":\"d9503c157ab88f0ed2fa1301aeb57e95ac564760\"},\"request\":{\"modules\":{\"tools\":\"lookup\"},\"pin\":\"01e338c335c07e4407239619e57361944a82cb8a\"},\"magit\":{\"modules\":{\"tools\":\"magit\"},\"pin\":\"48818355728c48d986d74dde8b1e9fba25f0fd53\"},\"magit-todos\":{\"modules\":{\"tools\":\"magit\"},\"pin\":\"cadf29d1cc410c71a0020c7f83999d9f61721b90\"},\"elisp-mode\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"ignore\":true},\"highlight-quoted\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"24103478158cd19fbcfb4339a3f1fa1f054f1469\"},\"macrostep\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"0b04a89f698c335c9ea492553470a8d45c113edd\"},\"overseer\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"02d49f582e80e36b4334c9187801c5ecfb027789\"},\"elisp-def\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"1d2e88a232ec16bce036b49577c4d4d96035f9f7\"},\"elisp-demos\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"8d0cd806b109076e6c4383edf59dbab9435dc5dc\"},\"flycheck-package\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"3a6aaed29ff61418c48c0251e1432c30748ae739\"},\"flycheck-cask\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"4b2ede6362ded4a45678dfbef1876faa42edbd58\"},\"buttercup\":{\"modules\":{\"lang\":\"emacs-lisp\"},\"pin\":\"30c703d215b075aaede936a2c424f65b5f7b6391\"},\"markdown-mode\":{\"modules\":{\"lang\":\"markdown\"},\"pin\":\"c765b73b370f0fcaaa3cee28b2be69652e2d2c39\"},\"markdown-toc\":{\"modules\":{\"lang\":\"markdown\"},\"pin\":\"3d724e518a897343b5ede0b976d6fb46c46bcc01\"},\"edit-indirect\":{\"modules\":{\"lang\":\"markdown\"},\"pin\":\"f80f63822ffae78de38dbe72cacaeb1aaa96c732\"},\"evil-markdown\":{\"modules\":{\"lang\":\"markdown\"},\"recipe\":{\"host\":\"github\",\"repo\":\"Somelauw/evil-markdown\"},\"pin\":\"8e6cc68af83914b2fa9fd3a3b8472573dbcef477\"},\"org\":{\"modules\":{\"lang\":\"org\"},\"recipe\":{\"host\":\"github\",\"repo\":\"emacs-straight/org-mode\",\"files\":{\"defaults\":\"etc\"},\"depth\":1,\"build\":true,\"pre-build\":[\"progn\",[\"with-temp-file\",\"org-loaddefs.el\"],[\"with-temp-file\",\"org-version.el\",[\"let\",{\"version\":{\"with-temp-buffer\":{\"insert-file-contents\":[[\"doom-path\",\"lisp/org.el\"],null,0,1024],\"if\":[[\"re-search-forward\",\"^;; Version: \\\\([^\\n-]+\\\\)\",null,true],[\"match-string-no-properties\",1],\"Unknown\"]}}},[\"insert\",[\"format\",\"(defun org-release () %S)\\n\",\"version\"],[\"format\",\"(defun org-git-version (&rest _) \\\"%s-??-%s\\\")\\n\",\"version\",[\"cdr\",[\"doom-call-process\",\"git\",\"rev-parse\",\"--short\",\"HEAD\"]]],\"(provide 'org-version)\\n\"]]]],\"local-repo\":\"org\"},\"pin\":\"e90a8a69a7fa2d83c995b5d32bc0b24a68218ed3\"},\"org-contrib\":{\"modules\":{\"lang\":\"org\"},\"recipe\":{\"host\":\"github\",\"repo\":\"emacsmirror/org-contrib\",\"files\":{\"defaults\":\"lisp/*.el\"}},\"pin\":\"dc59cdd46be8f6854c5d6e9252263d0e4e62e896\"},\"avy\":{\"modules\":{\"lang\":\"org\",\"config\":\"default\"},\"pin\":\"be612110cb116a38b8603df367942e2bb3d9bdbe\"},\"htmlize\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"dd27bc3f26efd728f2b1f01f9e4ac4f61f2ffbf9\"},\"org-yt\":{\"modules\":{\"lang\":\"org\"},\"recipe\":{\"host\":\"github\",\"repo\":\"TobiasZawada/org-yt\"},\"pin\":\"56166f48e04d83668f70ed84706b7a4d8b1e5438\"},\"ox-clip\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"ff117cf3c619eef12eccc0ccbfa3f11adb73ea68\"},\"toc-org\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"6d3ae0fc47ce79b1ea06cabe21a3c596395409cd\"},\"org-cliplink\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"13e0940b65d22bec34e2de4bc8cba1412a7abfbc\"},\"evil-org\":{\"modules\":{\"lang\":\"org\"},\"recipe\":{\"host\":\"github\",\"repo\":\"hlissner/evil-org-mode\",\"flavor\":\"melpa\"},\"pin\":\"a9706da260c45b98601bcd72b1d2c0a24a017700\"},\"orgit\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"4a585029875a1dbbe96d8ac157bd2fd02875f289\"},\"ob-async\":{\"modules\":{\"lang\":\"org\"},\"pin\":\"9aac486073f5c356ada20e716571be33a350a982\"},\"company-shell\":{\"modules\":{\"lang\":\"sh\"},\"pin\":\"5f959a63a6e66eb0cbdac3168cad523a62cc2ccd\"},\"drag-stuff\":{\"modules\":{\"config\":\"default\"},\"pin\":\"6d06d846cd37c052d79acd0f372c13006aa7e7c8\"},\"link-hint\":{\"modules\":{\"config\":\"default\"},\"pin\":\"36ce929331f2838213bcaa1145ece4b73ce84afe\"}}"
        # i think this is better: (doom-packages-pinned-list) ; (("link-hint.el" . "36ce929331f2838213bcaa1145ece4b73ce84afe") ("drag-stuff.el" . "6d06d846cd37c052d79acd0f372c13006aa7e7c8") ("company-shell" . "5f959a63a6e66eb0cbdac3168cad523a62cc2ccd") ("ob-async" . "9aac486073f5c356ada20e716571be33a350a982") ("orgit" . "4a585029875a1dbbe96d8ac157bd2fd02875f289") ("evil-org-mode" . "a9706da260c45b98601bcd72b1d2c0a24a017700") ("org-cliplink" . "13e0940b65d22bec34e2de4bc8cba1412a7abfbc") ("toc-org" . "6d3ae0fc47ce79b1ea06cabe21a3c596395409cd") ("ox-clip" . "ff117cf3c619eef12eccc0ccbfa3f11adb73ea68") ("org-yt" . "56166f48e04d83668f70ed84706b7a4d8b1e5438") ("emacs-htmlize" . "dd27bc3f26efd728f2b1f01f9e4ac4f61f2ffbf9") ("avy" . "be612110cb116a38b8603df367942e2bb3d9bdbe") ("org-contrib" . "dc59cdd46be8f6854c5d6e9252263d0e4e62e896") ("org" . "e90a8a69a7fa2d83c995b5d32bc0b24a68218ed3") ("evil-markdown" . "8e6cc68af83914b2fa9fd3a3b8472573dbcef477") ("edit-indirect" . "f80f63822ffae78de38dbe72cacaeb1aaa96c732") ("markdown-toc" . "3d724e518a897343b5ede0b976d6fb46c46bcc01") ("markdown-mode" . "c765b73b370f0fcaaa3cee28b2be69652e2d2c39") ("emacs-buttercup" . "30c703d215b075aaede936a2c424f65b5f7b6391") ("flycheck-cask" . "4b2ede6362ded4a45678dfbef1876faa42edbd58") ("flycheck-package" . "3a6aaed29ff61418c48c0251e1432c30748ae739") ("elisp-demos" . "8d0cd806b109076e6c4383edf59dbab9435dc5dc") ("elisp-def" . "1d2e88a232ec16bce036b49577c4d4d96035f9f7") ("overseer.el" . "02d49f582e80e36b4334c9187801c5ecfb027789") ("macrostep" . "0b04a89f698c335c9ea492553470a8d45c113edd") ("highlight-quoted" . "24103478158cd19fbcfb4339a3f1fa1f054f1469") ("magit-todos" . "cadf29d1cc410c71a0020c7f83999d9f61721b90") ("emacs-request" . "01e338c335c07e4407239619e57361944a82cb8a") ("dumb-jump" . "d9503c157ab88f0ed2fa1301aeb57e95ac564760") ("eros" . "a9a92bdc6be0521a6a06eb464be55ed61946639c") ("quickrun" . "6f963189305e8311c8193ba774f4244eb1315f57") ("flycheck-popup-tip" . "ef86aad907f27ca076859d8d9416f4f7727619c6") ("flycheck" . "784f184cdd9f9cb4e3dbb997c09d93e954142842") ("git-modes" . "f0a0154bf48dd1c0c587596cf4cfd3c90f673a05") ("git-timemachine" . "d8ffd0d7cc4ab3dd7de494c9ea36dfd99e2744fa") ("magit" . "48818355728c48d986d74dde8b1e9fba25f0fd53") ("browse-at-remote" . "c020975a891438e278ad1855213d4f3d62c9fccb") ("vundo" . "24271862a2f746be038306eafe20f5eff55c4566") ("emacs-undo-fu-session" . "a6c4f73bc22401fd36e0f2fd4fe058bb28566d84") ("emacs-undo-fu" . "0e74116fd5c7797811a91ba4eadef50d67523eb6") ("fd-dired" . "458464771bb220b6eb87ccfd4c985c436e57dc7e") ("dired-rsync" . "7940d9154d0a908693999b0e1ea351a6d365c93d") ("dired-git-info" . "9461476a28a5fec0784260f6e318237c662c3430") ("diredfl" . "f9140b2c42151dca669003d685c9f079b2e3dc37") ("snippets" . "d490cba6d762e69b483be308bc387c1f785742f0") ("auto-yasnippet" . "6a9e406d0d7f9dfd6dff7647f358cb05a0b1637e") ("evil-vimish-fold" . "b6e0e6b91b8cd047e80debef1a536d9d49eef31a") ("vimish-fold" . "a6501cbfe3db791f9ca17fd986c7202a87f3adb8") ("yasnippet" . "76e1eee654ea9479ba1441f9c17567694e6a2096") ("evil-collection" . "8be4b75c86bc637dbcd14be7522d6da06df1747e") ("evil-quick-diff" . "69c883720b30a892c63bc89f49d4f0e8b8028908") ("exato" . "aee7af7b7a0e7551478f453d1de7d5b9cb2e06c4") ("evil-visualstar" . "06c053d8f7381f91c53311b1234872ca96ced752") ("evil-traces" . "82e8a7b4213aed140f6eb5f2cc33a09bb5587166") ("evil-textobj-anyblock" . "29280cd71a05429364cdceef2ff595ae8afade4d") ("evil-surround" . "8fad8540c490d94a820004f227552ca08e3e3857") ("evil-snipe" . "c2108d3932fcd2f75ac3e48250d6badd668f5b4f") ("evil-numbers" . "7a1b62afc12da2b582bf84d722e7b10ca8b97065") ("evil-nerd-commenter" . "3b197a2b559b06a7cf39978704b196f53dac802a") ("evil-lion" . "1e838a53b8f18a3c8bdf3e952186abc2ee9cb98e") ("evil-indent-plus" . "b4dacbfdb57f474f798bfbf5026d434d549eb65c") ("evil-exchange" . "5f0a2d41434c17c6fb02e4f744043775de1c63a2") ("evil-escape" . "819f1ee1cf3f69a1ae920e6004f2c0baeebbe077") ("evil-embrace.el" . "3081d37811b6a3dfaaf01d578c7ab7a746c6064d") ("evil-easymotion" . "f96c2ed38ddc07908db7c3c11bcd6285a3e8c2e9") ("evil-args" . "2671071a4a57eaee7cc8c27b9e4b6fc60fd2ccd3") ("evil" . "5fc16776c5eb00c956ec7e9d83facb6a38dd868d") ("persp-mode.el" . "df95ea710e2a72f7a88293b72137acb0ca024d90") ("vi-tilde-fringe" . "f1597a8d54535bb1d84b442577b2024e6f910308") ("git-gutter-fringe" . "648cb5b57faec55711803cdc9434e55a733c3eba") ("evil-goggles" . "0070c9d8447e1696f8713d0c13ff64ef0979d580") ("evil-anzu" . "d1e98ee6976437164627542909a25c6946497899") ("anzu" . "5abb37455ea44fa401d5f4c1bdc58adb2448db67") ("doom-modeline" . "93f240f7a0bf35511cfc0a8dd75786744b4bcf77") ("hl-todo" . "70ce48470c85f1441de2c9428a240c3287995846") ("emacs-solaire-mode" . "8af65fbdc50b25ed3214da949b8a484527c7cc14") ("themes" . "4aee1f5a0e54552669f747aa7c25e6027e73d76d") ("Emacs-wgrep" . "3132abd3750b8c87cbcf6942db952acfab5edccd") ("marginalia" . "866e50aee4f066b0903752c69b33e9b7cab93f97") ("embark" . "9a44418c349e41020cdc5ad1bd21e8c77a429062") ("consult-flycheck" . "3f2a7c17cc2fe64e0c07e3bf90e33c885c0d7062") ("consult-dir" . "ed8f0874d26f10f5c5b181ab9f2cf4107df8a0eb") ("consult" . "fe49dedd71802ff97be7b89f1ec4bd61b98c2b13") ("orderless" . "e6784026717a8a6a7dcd0bf31fd3414f148c542e") ("vertico" . "a28370d07f35c5387c7a9ec2e5b67f0d4598058d") ("emacs-company-dict" . "cd7b8394f6014c57897f65d335d6b2bd65dab1f4") ("company-mode" . "2ca3e29abf87392714bc2b26e50e1c0f4b9f4e2c") ("compat" . "ecf53005abf6f0325d14e0e024222e22e982c8dd") ("emacs-which-key" . "4d20bc852545a2e602f59084a630f888542052b1") ("general.el" . "833dea2c4a60e06fcd552b653dfc8960935c9fb4") ("project" . "ce140cdb70138a4938c999d4606a52dbeced4676") ("projectile" . "971cd5c4f25ff1f84ab7e8337ffc7f89f67a1b52") ("ws-butler" . "572a10c11b6cb88293de48acbb59a059d36f9ba5") ("smartparens" . "79a338db115f441cd47bb91e6f75816c5e78a772") ("pcre2el" . "018531ba0cf8e2b28d1108136a0e031b6a45f1c1") ("helpful" . "66ba816b26b68dd7df08e86f8b96eaae16c8d6a2") ("dtrt-indent" . "e0630f74f915c6cded05f76f66d66e540fcc37c3") ("better-jumper" . "47622213783ece37d5337dc28d33b530540fc319") ("restart-emacs" . "1607da2bc657fe05ae01f7fdf26f716eafead02c") ("rainbow-delimiters" . "f40ece58df8b2f0fb6c8576b527755a552a5e763") ("highlight-numbers" . "8b4744c7f46c72b1d3d599d4fb75ef8183dee307") ("emacs-hide-mode-line" . "bc5d293576c5e08c29e694078b96a5ed85631942") ("nerd-icons.el" . "619a0382d2e159f3142c4200fe4cfc2e89247ef1") ("all-the-icons.el" . "be9d5dcda9c892e8ca1535e288620eec075eb0be") ("straight.el" . "5e84c4e2cd8ca79560477782ee4c9e5187725def") ("explain-pause-mode" . "2356c8c3639cbeeb9751744dbe737267849b4b51") ("gcmh" . "0089f9c3a6d4e9a310d0791cf6fa8f35642ecfd9") ("auto-minor-mode" . "17cfa1b54800fdef2975c0c0531dad34846a5065") ("use-package" . "a6e856418d2ebd053b34e0ab2fda328abeba731c"))
        # (json-encode straight--recipe-cache) ; "{\"org-elpa\":{\"local-repo\":null,\"package\":\"org-elpa\",\"type\":\"git\"},\"melpa\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"melpa/melpa\",\"build\":null,\"package\":\"melpa\",\"local-repo\":\"melpa\"},\"nongnu-elpa\":{\"type\":\"git\",\"repo\":\"https://git.savannah.gnu.org/git/emacs/nongnu.git\",\"local-repo\":\"nongnu-elpa\",\"build\":null,\"package\":\"nongnu-elpa\"},\"gnu-elpa-mirror\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"emacs-straight/gnu-elpa-mirror\",\"build\":null,\"package\":\"gnu-elpa-mirror\",\"local-repo\":\"gnu-elpa-mirror\"},\"el-get\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"dimitri/el-get\",\"build\":null,\"files\":[\"*.el\",[\"recipes\",\"recipes/el-get.rcp\"],\"methods\",\"el-get-pkg.el\"],\"flavor\":\"melpa\",\"package\":\"el-get\",\"local-repo\":\"el-get\"},\"emacsmirror-mirror\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"emacs-straight/emacsmirror-mirror\",\"build\":null,\"package\":\"emacsmirror-mirror\",\"local-repo\":\"emacsmirror-mirror\"},\"use-package\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",[\"exclude\",\"bind-key.el\",\"bind-chord.el\",\"use-package-chords.el\",\"use-package-ensure-system-package.el\"],\"use-package-pkg.el\"],\"host\":\"github\",\"repo\":\"jwiegley/use-package\",\"package\":\"use-package\",\"local-repo\":\"use-package\"},\"auto-minor-mode\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"joewreschnig/auto-minor-mode\",\"package\":\"auto-minor-mode\",\"local-repo\":\"auto-minor-mode\"},\"gcmh\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"gitlab\",\"repo\":\"koral/gcmh\",\"package\":\"gcmh\",\"local-repo\":\"gcmh\"},\"explain-pause-mode\":{\"host\":\"github\",\"repo\":\"lastquestion/explain-pause-mode\",\"package\":\"explain-pause-mode\",\"type\":\"git\",\"local-repo\":\"explain-pause-mode\"},\"straight\":{\"host\":\"github\",\"repo\":\"radian-software/straight.el\",\"branch\":\"develop\",\"local-repo\":\"straight.el\",\"files\":[\"straight*.el\"],\"package\":\"straight\",\"type\":\"git\"},\"all-the-icons\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"data\",\"all-the-icons-pkg.el\"],\"host\":\"github\",\"repo\":\"domtronn/all-the-icons.el\",\"package\":\"all-the-icons\",\"local-repo\":\"all-the-icons.el\"},\"nerd-icons\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"data\",\"nerd-icons-pkg.el\"],\"host\":\"github\",\"repo\":\"rainstormstudio/nerd-icons.el\",\"package\":\"nerd-icons\",\"local-repo\":\"nerd-icons.el\"},\"hide-mode-line\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"hlissner/emacs-hide-mode-line\",\"package\":\"hide-mode-line\",\"local-repo\":\"emacs-hide-mode-line\"},\"highlight-numbers\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Fanael/highlight-numbers\",\"package\":\"highlight-numbers\",\"local-repo\":\"highlight-numbers\"},\"rainbow-delimiters\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Fanael/rainbow-delimiters\",\"package\":\"rainbow-delimiters\",\"local-repo\":\"rainbow-delimiters\"},\"restart-emacs\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"iqbalansari/restart-emacs\",\"package\":\"restart-emacs\",\"local-repo\":\"restart-emacs\"},\"better-jumper\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"gilbertw1/better-jumper\",\"package\":\"better-jumper\",\"local-repo\":\"better-jumper\"},\"dtrt-indent\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"jscheid/dtrt-indent\",\"package\":\"dtrt-indent\",\"local-repo\":\"dtrt-indent\"},\"helpful\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Wilfred/helpful\",\"package\":\"helpful\",\"local-repo\":\"helpful\"},\"pcre2el\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"joddie/pcre2el\",\"package\":\"pcre2el\",\"local-repo\":\"pcre2el\"},\"smartparens\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Fuco1/smartparens\",\"package\":\"smartparens\",\"local-repo\":\"smartparens\"},\"ws-butler\":{\"host\":\"github\",\"repo\":\"hlissner/ws-butler\",\"flavor\":\"melpa\",\"package\":\"ws-butler\",\"type\":\"git\",\"local-repo\":\"ws-butler\"},\"projectile\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"bbatsov/projectile\",\"package\":\"projectile\",\"local-repo\":\"projectile\"},\"project\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"emacs-straight/project\",\"files\":[\"*\",{\"exclude\":\".git\"}],\"package\":\"project\",\"local-repo\":\"project\"},\"general\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"noctuid/general.el\",\"package\":\"general\",\"local-repo\":\"general.el\"},\"which-key\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"justbur/emacs-which-key\",\"package\":\"which-key\",\"local-repo\":\"emacs-which-key\"},\"compat\":{\"host\":\"github\",\"repo\":\"emacs-compat/compat\",\"files\":[\"*\",{\"exclude\":\".git\"}],\"package\":\"compat\",\"type\":\"git\",\"local-repo\":\"compat\"},\"company\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"icons\",[\"images/small\",\"doc/images/small/*.png\"],\"company-pkg.el\"],\"host\":\"github\",\"repo\":\"company-mode/company-mode\",\"package\":\"company\",\"local-repo\":\"company-mode\"},\"company-dict\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"hlissner/emacs-company-dict\",\"package\":\"company-dict\",\"local-repo\":\"emacs-company-dict\"},\"vertico\":{\"host\":\"github\",\"repo\":\"minad/vertico\",\"files\":[\"*.el\",\"extensions/*.el\"],\"flavor\":\"melpa\",\"package\":\"vertico\",\"type\":\"git\",\"local-repo\":\"vertico\"},\"orderless\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"oantolin/orderless\",\"package\":\"orderless\",\"local-repo\":\"orderless\"},\"consult\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"minad/consult\",\"package\":\"consult\",\"local-repo\":\"consult\"},\"consult-dir\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"karthink/consult-dir\",\"package\":\"consult-dir\",\"local-repo\":\"consult-dir\"},\"consult-flycheck\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"minad/consult-flycheck\",\"package\":\"consult-flycheck\",\"local-repo\":\"consult-flycheck\"},\"embark\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"embark.el\",\"embark-org.el\",\"embark.texi\",\"embark-pkg.el\"],\"host\":\"github\",\"repo\":\"oantolin/embark\",\"package\":\"embark\",\"local-repo\":\"embark\"},\"embark-consult\":{\"flavor\":\"melpa\",\"files\":[\"embark-consult.el\",\"embark-consult-pkg.el\"],\"package\":\"embark-consult\",\"local-repo\":\"embark\",\"type\":\"git\",\"repo\":\"oantolin/embark\",\"host\":\"github\"},\"marginalia\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"minad/marginalia\",\"package\":\"marginalia\",\"local-repo\":\"marginalia\"},\"wgrep\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"wgrep.el\",\"wgrep-pkg.el\"],\"host\":\"github\",\"repo\":\"mhayashi1120/Emacs-wgrep\",\"package\":\"wgrep\",\"local-repo\":\"Emacs-wgrep\"},\"doom-themes\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"themes/*.el\",\"themes/*/*.el\",\"extensions/*.el\",\"doom-themes-pkg.el\"],\"host\":\"github\",\"repo\":\"doomemacs/themes\",\"package\":\"doom-themes\",\"local-repo\":\"themes\"},\"solaire-mode\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"hlissner/emacs-solaire-mode\",\"package\":\"solaire-mode\",\"local-repo\":\"emacs-solaire-mode\"},\"hl-todo\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"tarsius/hl-todo\",\"package\":\"hl-todo\",\"local-repo\":\"hl-todo\"},\"doom-modeline\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"seagle0128/doom-modeline\",\"package\":\"doom-modeline\",\"local-repo\":\"doom-modeline\"},\"anzu\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacsorphanage/anzu\",\"package\":\"anzu\",\"local-repo\":\"anzu\"},\"evil-anzu\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacsorphanage/evil-anzu\",\"package\":\"evil-anzu\",\"local-repo\":\"evil-anzu\"},\"evil-goggles\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"edkolev/evil-goggles\",\"package\":\"evil-goggles\",\"local-repo\":\"evil-goggles\"},\"git-gutter-fringe\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacsorphanage/git-gutter-fringe\",\"package\":\"git-gutter-fringe\",\"local-repo\":\"git-gutter-fringe\"},\"vi-tilde-fringe\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"syl20bnr/vi-tilde-fringe\",\"package\":\"vi-tilde-fringe\",\"local-repo\":\"vi-tilde-fringe\"},\"persp-mode\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Bad-ptr/persp-mode.el\",\"package\":\"persp-mode\",\"local-repo\":\"persp-mode.el\"},\"evil\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"doc/build/texinfo/evil.texi\",{\"exclude\":\"evil-test-helpers.el\"},\"evil-pkg.el\"],\"host\":\"github\",\"repo\":\"emacs-evil/evil\",\"package\":\"evil\",\"local-repo\":\"evil\"},\"evil-args\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"wcsmith/evil-args\",\"package\":\"evil-args\",\"local-repo\":\"evil-args\"},\"evil-easymotion\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"PythonNut/evil-easymotion\",\"package\":\"evil-easymotion\",\"local-repo\":\"evil-easymotion\"},\"evil-embrace\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"cute-jumper/evil-embrace.el\",\"package\":\"evil-embrace\",\"local-repo\":\"evil-embrace.el\"},\"evil-escape\":{\"host\":\"github\",\"repo\":\"hlissner/evil-escape\",\"flavor\":\"melpa\",\"package\":\"evil-escape\",\"type\":\"git\",\"local-repo\":\"evil-escape\"},\"evil-exchange\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Dewdrops/evil-exchange\",\"package\":\"evil-exchange\",\"local-repo\":\"evil-exchange\"},\"evil-indent-plus\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"TheBB/evil-indent-plus\",\"package\":\"evil-indent-plus\",\"local-repo\":\"evil-indent-plus\"},\"evil-lion\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"edkolev/evil-lion\",\"package\":\"evil-lion\",\"local-repo\":\"evil-lion\"},\"evil-nerd-commenter\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"redguardtoo/evil-nerd-commenter\",\"package\":\"evil-nerd-commenter\",\"local-repo\":\"evil-nerd-commenter\"},\"evil-numbers\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"juliapath/evil-numbers\",\"package\":\"evil-numbers\",\"local-repo\":\"evil-numbers\"},\"evil-snipe\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"hlissner/evil-snipe\",\"package\":\"evil-snipe\",\"local-repo\":\"evil-snipe\"},\"evil-surround\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacs-evil/evil-surround\",\"package\":\"evil-surround\",\"local-repo\":\"evil-surround\"},\"evil-textobj-anyblock\":{\"host\":\"github\",\"repo\":\"willghatch/evil-textobj-anyblock\",\"branch\":\"fix-inner-block\",\"flavor\":\"melpa\",\"package\":\"evil-textobj-anyblock\",\"type\":\"git\",\"local-repo\":\"evil-textobj-anyblock\"},\"evil-traces\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"mamapanda/evil-traces\",\"package\":\"evil-traces\",\"local-repo\":\"evil-traces\"},\"evil-visualstar\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"bling/evil-visualstar\",\"package\":\"evil-visualstar\",\"local-repo\":\"evil-visualstar\"},\"exato\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"ninrod/exato\",\"package\":\"exato\",\"local-repo\":\"exato\"},\"evil-quick-diff\":{\"host\":\"github\",\"repo\":\"rgrinberg/evil-quick-diff\",\"package\":\"evil-quick-diff\",\"type\":\"git\",\"local-repo\":\"evil-quick-diff\"},\"evil-collection\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"modes\",\"evil-collection-pkg.el\"],\"host\":\"github\",\"repo\":\"emacs-evil/evil-collection\",\"package\":\"evil-collection\",\"local-repo\":\"evil-collection\"},\"yasnippet\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"yasnippet.el\",\"snippets\",\"yasnippet-pkg.el\"],\"host\":\"github\",\"repo\":\"joaotavora/yasnippet\",\"package\":\"yasnippet\",\"local-repo\":\"yasnippet\"},\"vimish-fold\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"matsievskiysv/vimish-fold\",\"package\":\"vimish-fold\",\"local-repo\":\"vimish-fold\"},\"evil-vimish-fold\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"alexmurray/evil-vimish-fold\",\"package\":\"evil-vimish-fold\",\"local-repo\":\"evil-vimish-fold\"},\"auto-yasnippet\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"abo-abo/auto-yasnippet\",\"package\":\"auto-yasnippet\",\"local-repo\":\"auto-yasnippet\"},\"doom-snippets\":{\"host\":\"github\",\"repo\":\"doomemacs/snippets\",\"files\":{\"defaults\":\"*\"},\"package\":\"doom-snippets\",\"type\":\"git\",\"local-repo\":\"snippets\"},\"diredfl\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"purcell/diredfl\",\"package\":\"diredfl\",\"local-repo\":\"diredfl\"},\"dired-git-info\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"emacs-straight/dired-git-info\",\"files\":[\"*\",{\"exclude\":\".git\"}],\"package\":\"dired-git-info\",\"local-repo\":\"dired-git-info\"},\"dired-rsync\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"dired-rsync.el\",\"dired-rsync-pkg.el\"],\"host\":\"github\",\"repo\":\"stsquad/dired-rsync\",\"package\":\"dired-rsync\",\"local-repo\":\"dired-rsync\"},\"fd-dired\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"yqrashawn/fd-dired\",\"package\":\"fd-dired\",\"local-repo\":\"fd-dired\"},\"undo-fu\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"codeberg\",\"repo\":\"ideasman42/emacs-undo-fu\",\"package\":\"undo-fu\",\"local-repo\":\"emacs-undo-fu\"},\"undo-fu-session\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"codeberg\",\"repo\":\"ideasman42/emacs-undo-fu-session\",\"package\":\"undo-fu-session\",\"local-repo\":\"emacs-undo-fu-session\"},\"vundo\":{\"type\":\"git\",\"host\":\"github\",\"repo\":\"emacs-straight/vundo\",\"files\":[\"*\",{\"exclude\":\".git\"}],\"package\":\"vundo\",\"local-repo\":\"vundo\"},\"browse-at-remote\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"rmuslimov/browse-at-remote\",\"package\":\"browse-at-remote\",\"local-repo\":\"browse-at-remote\"},\"git-commit\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"lisp/git-commit.el\",\"lisp/git-commit-pkg.el\",\"git-commit-pkg.el\"],\"host\":\"github\",\"repo\":\"magit/magit\",\"package\":\"git-commit\",\"local-repo\":\"magit\"},\"git-timemachine\":{\"host\":\"github\",\"repo\":\"emacsmirror/git-timemachine\",\"flavor\":\"melpa\",\"package\":\"git-timemachine\",\"type\":\"git\",\"local-repo\":\"git-timemachine\"},\"git-modes\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"magit/git-modes\",\"package\":\"git-modes\",\"local-repo\":\"git-modes\"},\"flycheck\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"flycheck/flycheck\",\"package\":\"flycheck\",\"local-repo\":\"flycheck\"},\"flycheck-popup-tip\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"flycheck/flycheck-popup-tip\",\"package\":\"flycheck-popup-tip\",\"local-repo\":\"flycheck-popup-tip\"},\"quickrun\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacsorphanage/quickrun\",\"package\":\"quickrun\",\"local-repo\":\"quickrun\"},\"eros\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"xiongtx/eros\",\"package\":\"eros\",\"local-repo\":\"eros\"},\"dumb-jump\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"jacktasia/dumb-jump\",\"package\":\"dumb-jump\",\"local-repo\":\"dumb-jump\"},\"request\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"request.el\",\"request-pkg.el\"],\"host\":\"github\",\"repo\":\"tkf/emacs-request\",\"package\":\"request\",\"local-repo\":\"emacs-request\"},\"magit\":{\"flavor\":\"melpa\",\"files\":[\"lisp/magit*.el\",\"lisp/git-rebase.el\",\"docs/magit.texi\",\"docs/AUTHORS.md\",\"LICENSE\",\"Documentation/magit.texi\",\"Documentation/AUTHORS.md\",[\"exclude\",\"lisp/magit-libgit.el\",\"lisp/magit-libgit-pkg.el\",\"lisp/magit-section.el\",\"lisp/magit-section-pkg.el\"],\"magit-pkg.el\"],\"package\":\"magit\",\"local-repo\":\"magit\",\"type\":\"git\",\"repo\":\"magit/magit\",\"host\":\"github\"},\"magit-todos\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"alphapapa/magit-todos\",\"package\":\"magit-todos\",\"local-repo\":\"magit-todos\"},\"highlight-quoted\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Fanael/highlight-quoted\",\"package\":\"highlight-quoted\",\"local-repo\":\"highlight-quoted\"},\"macrostep\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"emacsorphanage/macrostep\",\"package\":\"macrostep\",\"local-repo\":\"macrostep\"},\"overseer\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"tonini/overseer.el\",\"package\":\"overseer\",\"local-repo\":\"overseer.el\"},\"elisp-def\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Wilfred/elisp-def\",\"package\":\"elisp-def\",\"local-repo\":\"elisp-def\"},\"elisp-demos\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"*.org\",\"elisp-demos-pkg.el\"],\"host\":\"github\",\"repo\":\"xuchunyang/elisp-demos\",\"package\":\"elisp-demos\",\"local-repo\":\"elisp-demos\"},\"flycheck-package\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"purcell/flycheck-package\",\"package\":\"flycheck-package\",\"local-repo\":\"flycheck-package\"},\"flycheck-cask\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"flycheck/flycheck-cask\",\"package\":\"flycheck-cask\",\"local-repo\":\"flycheck-cask\"},\"buttercup\":{\"type\":\"git\",\"flavor\":\"melpa\",\"files\":[\"defaults\",\"bin\",\"buttercup-pkg.el\"],\"host\":\"github\",\"repo\":\"jorgenschaefer/emacs-buttercup\",\"package\":\"buttercup\",\"local-repo\":\"emacs-buttercup\"},\"markdown-mode\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"jrblevin/markdown-mode\",\"package\":\"markdown-mode\",\"local-repo\":\"markdown-mode\"},\"markdown-toc\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"ardumont/markdown-toc\",\"package\":\"markdown-toc\",\"local-repo\":\"markdown-toc\"},\"edit-indirect\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Fanael/edit-indirect\",\"package\":\"edit-indirect\",\"local-repo\":\"edit-indirect\"},\"evil-markdown\":{\"host\":\"github\",\"repo\":\"Somelauw/evil-markdown\",\"package\":\"evil-markdown\",\"type\":\"git\",\"local-repo\":\"evil-markdown\"},\"org\":{\"host\":\"github\",\"repo\":\"emacs-straight/org-mode\",\"files\":{\"defaults\":\"etc\"},\"depth\":1,\"build\":true,\"pre-build\":[\"progn\",[\"with-temp-file\",\"org-loaddefs.el\"],[\"with-temp-file\",\"org-version.el\",[\"let\",{\"version\":{\"with-temp-buffer\":{\"insert-file-contents\":[[\"doom-path\",\"lisp/org.el\"],null,0,1024],\"if\":[[\"re-search-forward\",\"^;; Version: \\\\([^\\n-]+\\\\)\",null,true],[\"match-string-no-properties\",1],\"Unknown\"]}}},[\"insert\",[\"format\",\"(defun org-release () %S)\\n\",\"version\"],[\"format\",\"(defun org-git-version (&rest _) \\\"%s-??-%s\\\")\\n\",\"version\",[\"cdr\",[\"doom-call-process\",\"git\",\"rev-parse\",\"--short\",\"HEAD\"]]],\"(provide 'org-version)\\n\"]]]],\"local-repo\":\"org\",\"package\":\"org\",\"type\":\"git\"},\"org-contrib\":{\"host\":\"github\",\"repo\":\"emacsmirror/org-contrib\",\"files\":{\"defaults\":\"lisp/*.el\"},\"package\":\"org-contrib\",\"type\":\"git\",\"local-repo\":\"org-contrib\"},\"avy\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"abo-abo/avy\",\"package\":\"avy\",\"local-repo\":\"avy\"},\"htmlize\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"hniksic/emacs-htmlize\",\"package\":\"htmlize\",\"local-repo\":\"emacs-htmlize\"},\"org-yt\":{\"host\":\"github\",\"repo\":\"TobiasZawada/org-yt\",\"package\":\"org-yt\",\"type\":\"git\",\"local-repo\":\"org-yt\"},\"ox-clip\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"jkitchin/ox-clip\",\"package\":\"ox-clip\",\"local-repo\":\"ox-clip\"},\"toc-org\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"snosov1/toc-org\",\"package\":\"toc-org\",\"local-repo\":\"toc-org\"},\"org-cliplink\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"rexim/org-cliplink\",\"package\":\"org-cliplink\",\"local-repo\":\"org-cliplink\"},\"evil-org\":{\"host\":\"github\",\"repo\":\"hlissner/evil-org-mode\",\"flavor\":\"melpa\",\"package\":\"evil-org\",\"type\":\"git\",\"local-repo\":\"evil-org-mode\"},\"orgit\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"magit/orgit\",\"package\":\"orgit\",\"local-repo\":\"orgit\"},\"ob-async\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"astahlman/ob-async\",\"package\":\"ob-async\",\"local-repo\":\"ob-async\"},\"company-shell\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"Alexander-Miller/company-shell\",\"package\":\"company-shell\",\"local-repo\":\"company-shell\"},\"drag-stuff\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"rejeep/drag-stuff.el\",\"package\":\"drag-stuff\",\"local-repo\":\"drag-stuff.el\"},\"link-hint\":{\"type\":\"git\",\"flavor\":\"melpa\",\"host\":\"github\",\"repo\":\"noctuid/link-hint.el\",\"package\":\"link-hint\",\"local-repo\":\"link-hint.el\"}}"
        #
        # Currently straight-normalize-all is used to get both variables/the func to populate,
        # but this will need to be changed as it does a lot more net I/O and git ops than is needed.
        #
        # THIS IS WRONG:: ~~The expr (straight--map-existing-repos-interactively (lambda (t) nil))
        # seems to populate all variables, too. So the normalization part of the codepath
        # isn't relevant.~~
        #
        # maybe it's just an autoload somethingsomething hook something??
        # straight-use-package-no-build?? maybe? straight-use-package is the only indirect path to puthash recipe cache
        #
        # OKAY. I got it, it's doom-initalize-packages that does(populates) everything needed. I think it might not
        # even do anything extra that we don't want.
        # its used in doom sync cli -> (doom-packages-install) -> func body starts w call (doom-initialize-packages)
        # oh also btw
        #   ckie@cookiemonster ~/git/nix-doom-emacs -> nix-instantiate --show-trace --json --eval --strict --expr 'with import <nixpkgs> {}; (callPackage ./. { doomPrivateDir = ./test/doom.d ;}).passthru.straightRecipes' | jq .
        # (it's also in the appropiate place in ./default.nix)
        # and 
        #   [nix-shell:~/git/doomemacs]$ emacs --init-directory .
        emacs -q \
              --batch \
              --directory=${epkgs.straight}/share/emacs/site-lisp \
              --load=${./setup.el} \
              ${
                lib.concatMapStringsSep "\n" (f: "--load=${f}") emacsLoadFiles
              } \
              --eval="(nix-straight-get-used-packages \"${emacsInitFile}\" \"$out\")" \
              ${lib.escapeShellArgs emacsArgs}
        runHook postInstall
      '';
    }) { };

  # It's up to the user to importJSON recipesIFD first, unfortunately,
  # since I don't want to mess with .overrideAttrs.
  packageList = recipes':
    map (x:
      if epkgs ? "${x}" then
        epkgs.${x}
      else if abortOnNotFound then
        abort "Package not available: ${x}"
      else
        (lib.warn "Package not available: ${x}") null) recipes';

  emacsEnv = epkgs.callPackage ({ stdenv, writeScript, ... }:
    { packages, straightDir }:
    let
      expandDependencies = packages:
        let
          withDeps = p:
            map (x:
              if x == null then
                [ ]
              else
                [ x ] ++ withDeps x.propagatedBuildInputs) (lib.flatten p);
        in (lib.unique
          (lib.filter (d: d ? ename) (lib.flatten (withDeps packages))));

      install = repo: packages:
        let
          installPkg = repo: pkg: (''
            REPO=${repo}
            psrc=(${pkg}/share/emacs/*/*/${pkg.ename}*)
            if [[ ! -d $psrc ]]; then
              elpa_path=(${pkg}/share/emacs/site-lisp/elpa/*)
              if [[ -d $elpa_path ]]; then
                ln -snf $elpa_path $REPO/${pkg.ename}
              else
                ln -snf ${pkg}/share/emacs/site-lisp $REPO/${pkg.ename}
              fi
            else
              ln -snf $psrc $REPO/${pkg.ename}
            fi
            ${ # TODO get rid of this junk
            lib.optionalString
            ((pkg.src ? meta) && (pkg.src.meta ? homepage)) ''
              if [[ ! -d $REPO/${baseNameOf pkg.src.meta.homepage} ]]; then
                ln -snf $psrc $REPO/${baseNameOf pkg.src.meta.homepage}
              fi
            ''}
          '');
        in writeScript "install-repo" ''
          mkdir -p ${repo}
          ${(lib.concatMapStringsSep "\n" (installPkg repo)
            (expandDependencies packages))}
        '';
    in stdenv.mkDerivation {
      name = "straight-emacs-env";
      buildPhase = ":";
      buildInputs = [ emacs ];
      installPhase = ''
        runHook preInstall

        mkdir -p $out
        ${(install "${straightDir}/repos" packages)}
        emacs -q \
              --batch \
              --directory=${epkgs.straight}/share/emacs/site-lisp \
              --load=${./setup.el} \
              ${
                lib.concatMapStringsSep "\n" (f: "--load=${f}") emacsLoadFiles
              } \
              --eval="(nix-straight-build-packages \"${emacsInitFile}\")" ${
                lib.escapeShellArgs emacsArgs
              } \
              || (cat $out/logs/cli.doom.*.error 1>&2 && false) # print a proper stacktrace if things fail

        runHook postInstall
      '';
    }) { };

in {
  /* Final environment (.emacs.d) with the populated `straight`` repository

     The required packages can be acquired from a call to
     `packageList` function.

     Type: emacsEnv :: { straightDir :: string, packages :: [derivation] } -> derivation

     Example:
       emacsEnv {
         straightDir = "$out/straight";
         packages = packageList (super: { ... } );
       };
  */
  inherit emacsEnv;
  /* Package list inferred from processing `emacsInitFile`

     The passed function will be called via an `overrideAttrs
     call on the`underlying derivation.

     Type: packageList :: attrs -> attrs -> derivation

     Example:
       packageList (super: {
         src = ...;
         preInstall = ''
           ...
         ''
       });
  */
  inherit packageList;

  /* Derivation containing a JSON structure of package recipes

     These are the packages needed to be populated in the
     `straight` repository.

     Type: recipesIFD :: TODO
  */
  inherit recipesIFD;
}
